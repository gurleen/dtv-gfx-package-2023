<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <link href="../../font/stylesheet.css" rel="stylesheet" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
        <script
            type="text/javascript"
            src="https://unpkg.com/external-svg-loader@1.6.10/svg-loader.min.js"
            async
        ></script>
        <script type="text/javascript" src="../../shared.js" defer></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"
            integrity="sha512-WFN04846sdKMIP5LKNphMaWzU7YpMyCU245etK3g/2ARYbPK9Ub18eG+ljU96qKRCWh+quCY7yefSmlkQw1ANQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <title>Around The Conference</title>
    </head>

    <body style="opacity: 1 !important">
        <div id="svg"></div>
        <script>
            window.onerror = console.error;

            window.onload = () => {
                loadSVG("Around The Conference.svg");

                tl.seek(tl.totalDuration());
                updateScores(true);
                setInterval(() => updateScores(true), 5000);
            };

            window.addEventListener("loaded", () => {
                for (var i = 1; i < 7; i++) {
                    console.log("Doing alignment");
                    let prefix = `#Game-${i}-Box > `;
                    let ident = `#Game-${i}-Ident > `;
                    /*
                    endAlignTextElement(prefix + "#Status");
                    endAlignTextElement(prefix + "#Away > #Away-Score");
                    endAlignTextElement(ident + "#Home-Team > #Name");
                    */
                }

                const leftScoreElements = ["text-55", "text-95", "text-105", "text-65", "text-75", "text-85"]
                const timeElements = ["text-57", "text-97", "text-107", "text-67", "text-77", "text-87"]
                const rightNameElements = ["text-3", "text-11", "text-19", "text-27", "text-35", "text-43"]

                leftScoreElements.forEach(id => endAlignText(id, 240))
                timeElements.forEach(id => middleAlignText(id, 248))
                rightNameElements.forEach(id => endAlignText(id, 240))
            });

            logoForTeam = (team) => {
                return `/logo/${team.team_id}`;
            };

            updateScores = (first) => {
                let games = get("/around-the-caa/mens");
                let i = 1;
                for (i = 0; i < 7; i++) {
                    try {
                        let game = games[i];
                        console.log(game);
                        let prefix = `#Game-${i}-Box > `;
                        qUpdateText(
                            prefix + "#Home > #Home-Score",
                            game.homeScore,
                        );
                        qUpdateText(
                            prefix + "#Away > #Away-Score",
                            game.awayScore,
                        );
                        qUpdateText(prefix + "#Status", game.status);
                        if (first) {
                            let identPrefix = `#Game-${i}-Ident > `;
                            qUpdateText(
                                identPrefix + "#Home-Team > #Name",
                                game.home.short_name,
                            );
                            qUpdateText(
                                identPrefix + "#Away-Team > #Name",
                                game.away.short_name,
                            );
                            qUpdateImage(
                                identPrefix + "#Home-Team > #Logo",
                                logoForTeam(game.home),
                            );
                            qUpdateImage(
                                identPrefix + "#Away-Team > #Logo",
                                logoForTeam(game.away),
                            );
                            qUpdateColor(
                                identPrefix + "#Home-Team > #Home-Team-Color",
                                "#" + game.home.color,
                            );
                            qUpdateColor(
                                identPrefix + "#Away-Team > #Away-Team-Color",
                                "#" + game.away.color,
                            );
                            qUpdateColor(
                                prefix + "#Home > #Home-Team-Color",
                                "#" + game.home.color,
                            );
                            qUpdateColor(
                                prefix + "#Away > #Away-Team-Color",
                                "#" + game.away.color,
                            );
                        }
                    } catch (e) {
                        console.error(e);
                    }
                }
            };

            window.handleExtra = async (k, v) => {};
        </script>
    </body>
</html>
